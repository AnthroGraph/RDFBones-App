<semantic-form

  new-subject-template="http://rdfbones.org/records/ResearchProcess-{{UUID}}"
  id="ResearchProcess"
post-action='event'
persistence='sparql'
browser-persistence=true
form-id="ResearchProcess"
fields='[{
    "id": "roletype",
    "label": "Select Roletype",
    "xsdDatatype": "xsd:anyURI",
    "maxOccurs": 1,
    "minOccurs": 1,
    "insertPattern": "
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX vivo: <http://vivoweb.org/ontology/core#>
      PREFIX phaleron-patho:<http://w3id.org/rdfbones/ext/phaleron-patho/>
      PREFIX cidoc:<http://www.cidoc-crm.org/cidoc-crm/>

      INSERT {GRAPH ?mygraph {  
        ?paleopath_observation obo:BFO_0000051  $subject.
        $subject a [[research_process_type]] .        
        ?role a $value .
        
        ?role obo:BFO_0000054 $subject .        
        $subject rdfs:label ?label .
       }} WHERE {
        GRAPH ?mygraph {?? a ?o } .
        ?paleopath_observation obo:OBI_0000299 ??.
        ?paleopath_observation a [[paleopath_observation_type]] .
        BIND(URI(CONCAT(STR(?subject),\"_Role\")) AS ?role) .
        $value rdfs:label ?label .
        

}",
"valueSetPattern": "
      PREFIX phaleron-patho:<http://w3id.org/rdfbones/ext/phaleron-patho/>

SELECT $value WHERE {
  VALUES (?value) { (phaleron-patho:ObserverRole) (phaleron-patho:DataEditorRole) } }

"
,
"deletePattern": "
    PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
    PREFIX obo: <http://purl.obolibrary.org/obo/>
    PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
    DELETE {?paleopath_observation obo:BFO_0000051  $subject.
            $subject rdfs:label $value .} WHERE {?paleopath_observation obo:OBI_0000299 ??.
            ?paleopath_observation a [[paleopath_observation_type]] .} "

},
{
  "id": "dateentry",
    "label": "Select Date",
    "xsdDatatype": "xsd:date",
    "maxOccurs": 1,
    "minOccurs": 1,
    "insertPattern": "
    PREFIX dc: <http://purl.org/dc#>
    PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

    INSERT {GRAPH ?mygraph {  
        $subject dc:date $value .
        
       }} WHERE {
        GRAPH ?mygraph {?? a ?o } .      
}",
 "deletePattern": "
    PREFIX dc: <http://purl.org/dc#>
    PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
    DELETE {$subject dc:date $value} WHERE { 
}" 

}


]'>
 <semantic-form-recover-notification></semantic-form-recover-notification>
<semantic-form-select-input for='roletype'></semantic-form-select-input>
<semantic-form-datetime-input for="dateentry" mode="date" >
</semantic-form-datetime-input>
<button name="submit" class="btn btn-primary"><strong>Save</strong></button>
<button name="reset" class="btn btn-secondary">Reset</button>
 </semantic-form>
<mp-event-proxy on-event-type="Form.ResourceCreated" on-event-source="ResearchProcess" proxy-event-type="RedirectAction.perform" proxy-targets='["redirect-to-resource"]'>
  </mp-event-proxy>
<mp-event-target-redirect id="redirect-to-resource" action="redirect" query-params="target='_blank'">
</mp-event-target-redirect>
    
<br>

<semantic-query query="
		       PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
		       PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
		       PREFIX obo: <http://purl.obolibrary.org/obo/>
		       PREFIX dc: <http://purl.org/dc#>
		       SELECT (count(DISTINCT ?RP) AS ?value) WHERE { 
		       ?paleopath_observation obo:OBI_0000299 ??.
		       ?paleopath_observation a [[paleopath_observation_type]] .
		       ?paleopath_observation obo:BFO_0000051  ?RP.
		       ?RP a [[research_process_type]] .        
		      
      } GROUP BY ?RP" template="{{> t}}">
  <template id="t">
    {{#ifCond bindings.0.value.value ">" "0"}}
<strong>Show all available Observer/Editing Events:</strong></hr>
<semantic-table 
  query="
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX dc: <http://purl.org/dc#>
      SELECT DISTINCT ?RP ?date ?typelabel ?typeofEvent ?homosapiens WHERE { 
             ?paleopath_observation obo:OBI_0000299 ??.
             ?paleopath_observation a [[paleopath_observation_type]] .
             ?paleopath_observation obo:BFO_0000051  ?RP.
             ?RP a [[research_process_type]] .        
             OPTIONAL {?RP dc:date ?date } .
             OPTIONAL {?typeofEvent obo:BFO_0000054 ?RP .
             ?typeofEvent a ?typeclass .
             ?typeclass rdfs:label ?typelabel} .
             OPTIONAL {?RP obo:RO_0000057 ?homosapiens.}
             

      }"
       options='{
      "enableGrouping": true,
      "groupingOptions": {"groupedBy": ["date"]}
    }'
  column-configuration='[
      {"variableName": "date", "displayName": "Date of Event"}
     ,
     {"variableName": "RP", "displayName": "Observer/Editing Event" },
   
     {"variableName": "typelabel", "displayName": "Type of Event"},
     {"variableName": "homosapiens", "displayName": "Person involved"}
    ]'
  ></semantic-table>
 {{/ifCond}}
 </template>
  </semantic-query>
